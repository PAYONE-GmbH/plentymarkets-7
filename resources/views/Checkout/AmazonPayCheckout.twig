{% if services.template.isCurrentTemplate('tpl.checkout') %}
    {#<div id="LoginWithAmazon"></div>#}
    {#<div id="LogoutWithAmazon" style="display:none;">Logout</div>#}
    <link rel="stylesheet" href="{{ plugin_path('Payone') }}/css/payone-amazonpay.css">

    <script type="text/javascript">
        console.log("{{ amazonPayMopId }}");

        // document.getElementById("LoginWithAmazon").style.display = "none";
        //document.getElementById("LogoutWithAmazon").style.display = "none";
       document.getElementById("addressBookWidgetDiv").style.display = "none";

        if ({{ currentPaymentId }} == {{ amazonPayMopId }} ) {
            // document.getElementById("LoginWithAmazon").style.display = "block";
            loadAmazonLoginButton();
        }

        document.addEventListener("afterPaymentMethodChanged", function (e) {
            if (e.detail == {{ amazonPayMopId }} ) {
                // document.getElementById("LoginWithAmazon").style.display = "block";
                loadAmazonLoginButton();
            } else {
                //document.getElementById("LoginWithAmazon").style.display = "block";
                // document.getElementById("walletWidgetDiv").style.display = "block";
                //document.getElementById("addressBookWidgetDiv").style.display = "block";
            }
        });

        function loadAmazonLoginButton() {
            if (App.templateType === "checkout") {
                console.log("loadAmazonLoginButton");

                $("li.method-list-item[data-id={{ amazonPayMopId }}]").append("<label class='provider-select-label' <div class='content' <div id='LoginWithAmazon'></div></div></label>");
                $("li.method-list-item[data-id={{ amazonPayMopId }}]").append("<label class='provider-select-label' <div class='content' <div id='LogoutWithAmazon' style='display:none'>'Logout'</div></div></label>");
                $("li.method-list-item[data-id={{ amazonPayMopId }}]").after("<div id='walletWidgetDiv' class='walletWidgetDiv' style='display:none'></div>");


                $.get("/payment/payone/checkout/amazonPay/loginButton", function (data) {
                    //$('#LoginWithAmazon').append(data);
                    $("body").append(data);
                });
                document.getElementById('LogoutWithAmazon').onclick = function () {
                    amazon.Login.logout();
                    document.getElementById("LoginWithAmazon").style.display = "block";
                    document.getElementById("LogoutWithAmazon").style.display = "none";
                    document.getElementById("addressBookWidgetDiv").style.display = "none";
                    document.getElementById("walletWidgetDiv").style.display = "none";
                };
            }
        }
    </script>
{% endif %}

{# @var creditcardcheck \Payone\Models\CreditCardCheckRequestData #}
<link rel="stylesheet" href="{{ plugin_path('Payone') }}/css/payone-iframe.css">
{{ errorMessage|raw }}
<style type="text/css" media="screen, projection"></style>

<div id="payonePaymentModal" class="method-presentation">
    <div class="method-title">
        <div class="method-option form-check-label">
            <h3>{{ paymentMethod.name }}:</h3>
            <div class="method-icon">
                <img src="{{ paymentMethod.icon }}" alt="{{ paymentMethod.name }} icon">
            </div>
            <div class="description">{{ paymentMethod.description }}</div>
        </div>
    </div>

    <script type="text/javascript" src="https://secure.pay1.de/client-api/js/v1/payone_hosted_min.js" async></script>
    <script type="text/javascript" src="{{ plugin_path('Payone') }}/js/payone-iframe.js" defer></script>

    <form id="orderPlaceForm" name="paymentform" action="place-order">
        <fieldset>
            <div class="form-group row">
                <div class="form-group row">
                    <label for="cardpan"
                           class="col-sm-3 col-form-label col-form-label-lg">{{ trans('Payone::Template.ccNumber') }}
                        :</label>
                    <div id="cardpan" class="inputIframe col-sm-9"></div>
                </div>

                <div class="form-group row">
                    <label for="cardtype">{{ trans('Payone::Template.ccType') }}:</label>
                    <div id="cardtypecol-sm-9" class="inputIframe"></div>
                </div>

                <div class="form-group row">
                    <label for="cardcvc2">CVC:</label>
                    <div id="cardcvc2" class="inputIframe col-sm-9"></div>
                </div>

                <div class="form-group row">
                    <label for="expire"
                           class="col-sm-3 col-form-label col-form-label-lg">{{ trans('Payone::Template.ccValidTo') }}
                        :</label>
                    <div class="col-sm-9 inputIframe" id="expireInput">
                        <div id="cardexpiremonth" class="col-sm-3"></div>
                        <div id="cardexpireyear" class="col-sm-6"></div>
                    </div>
                </div>

                <div class="form-group row">
                    <label for="firstname"
                           class="col-sm-3 col-form-label col-form-label-lg">{{ trans('Payone::Template.firstName') }}
                        :</label>
                    <div class="col-sm-9">
                        <input id="firstname" name="firstname" type="text" class="form-control form-control-lg"
                               required="required" autocomplete="off">
                    </div>
                </div>

                <div class="form-group row">
                    <label for="lastname"
                           class="col-sm-3 col-form-label col-form-label-lg">{{ trans('Payone::Template.lastName') }}
                        :</label>
                    <div class="col-sm-9">
                        <input id="lastname" name="lastname" type="text" class="form-control form-control-lg"
                               required="required" autocomplete="off">
                    </div>
                </div>

                <div id="errorOutput"></div>

                <button id="orderCancel" class="btn btn-secondary btn-block payone-cancel" data-dismiss="modal"
                        @click="clearFields"
                        aria-label="{{ trans('Payone::Template.orderCancel') }}">
                    <i class="fa fa-arrow-left"></i> {{ trans('Payone::Template.orderCancel') }}
                </button>
                {% if errorMessage is empty %}
                    <button id="orderPlace" class="btn btn-primary btn-block">
                        <i class="fa fa-arrow-right"
                           aria-hidden="true"></i> {{ trans('Payone::Template.orderPlace') }}
                    </button>
                {% endif %}
            </div>
        </fieldset>
    </form>

    <script type="text/javascript">
        var config = {
            autoCardtypeDetection: {
                supportedCardtypes: {{ ccTypes|json_encode|raw }},
                deactivate: false
            },
            fields: {
                cardtype: {
                    selector: "cardtype",
                    cardtypes: {{ ccTypes|json_encode|raw }}
                },
                cardpan: {
// put name of your div-container here
// define possible cardtypes in PAYONE iFrame
// put name of your div-container here // text (default), password, tel
                    size: "19",
                    maxlength: "19", // set max. length for CVC input; empty values possible length: { "A": 4, "V": 3, "M": 3, "J": 0 } // set required CVC length per cardtype
                    selector: "cardpan",
                    type: "text",
                    style: "font-size: 1em; border: 1px solid #000;"
                },
                cardcvc2: {
                    selector: "cardcvc2",                // put name of your div-container here
                    type: "password",                    // select(default), text, password, tel
                    style: "font-size: 1em; border: 1px solid #000;",
                    size: "4",
                    maxlength: "4"
                },
                cardexpiremonth: {
                    selector: "cardexpiremonth", type: "select",
                    size: "2",
                    maxlength: "2",
                    iframe: {
                        width: "50px"
                    }
                },
                cardexpireyear: {
                    selector: "cardexpireyear", type: "select",
                    iframe: {
                        width: "80px"
                    }
                }
            },
// if set exact length required; 0=CVC input disabled
// put name of your div-container here // select(default), text, password, tel
// put name of your div-container here // select(default), text, password, tel
            defaultStyle: {
                input: "font-family: Helvetica; padding: .75rem 1.5rem; color: #7a7f7f;font-size: 1.25rem; border-radius: .2rem;; width: 100%; border: 1px solid rgba(0,0,0,.15);",
                select: "font-family: Helvetica;font-size: 1.25rem; color: #7a7f7f; line-height: 1.25;",
                iframe: {
                    width: "100%"
                }
            },
            error: "errorOutput",
        };
        var Templates = {};
        Templates.locale = '{{ locale }}';
        Templates.errorMessage =
            '<div id="checkoutError" class="row is-table-row error">' +
            '     <div class="col-sm-12">' +
            '        <p>' +
            '            <h4>{{ trans("Payone::Template.orderErrorTitle") }}</h4>' +
            '        </p>' +
            '        <p>' +
            '                <span class="text-muted">' +
            '                       {% if isDebugModeEnabled %}' +
            '                           {errorMessage}' +
            '                       {% else %}' +
            '                           {{ trans("Payone::Template.orderErrorMessage") }}' +
            '                       {% endif %}' +
            '                </span>' +
            '        <a href="checkout"> <button class="btn btn-primary btn-block Payone-cancel">' +
            '                <i class="fa fa-arrow-right"' +
            '                  aria-hidden="true"></i> {{ trans("Payone::Template.orderCancel") }}' +
            '        </button></a>' +
            '        </p>' +
            '    </div>' +
            '</div>';

        var request = {{ creditcardcheck|json_encode|raw }};

    </script>
</div>